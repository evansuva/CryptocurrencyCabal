<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Class 03: Digital Signatures // Cryptocurrency Cabal
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.15-DEV" />

  <meta property="og:title" content="Class 03: Digital Signatures" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://localhost:1313/classes/class3/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Open+Sans:400,400italic,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Special+Elite' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/rotunda.png">
  <link rel="shortcut icon" href="/rotunda.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Cryptocurrency Cabal" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  <link rel="stylesheet" href="http://localhost:1313//css/cabal.css">

  
 
  
<script>
function showText(show,hide)
{
    document.getElementById(show).className = "show";
    document.getElementById(hide).className = "hide";
}
</script>
 

  

  
</head>

<body>
	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    


    <a href="http://localhost:1313/"><h1 class="brand-title">Crypto Currency Cabal</h1></a>
    <h2 class="brand-tagline">University of Virginia
    <br>cs4501 Fall 2015
    </h2>

    <nav class="nav">
      <ul class="nav-list">
        
          <li class="nav-item">
          
              <a href=""></a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/syllabus/">Syllabus</a>
          
          </li>
        
      </ul>
    </nav>

    <b><a href="/ps/">Assignments</a></b>
    <nav class="nav">
      <ul class="nav-list">
        
          <li class="nav-item">
          
              <a href="/ps/ps1/">PS1: Bitcoin Transactions</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/ps/ps2/">PS2: The Blockchain</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/registration/">Registration</a>
          
          </li>
        
      </ul>
    </nav>

    <b><A href="/classes/">Classes</a></b>
    <nav class="nav">
      <ul class="nav-list">
        
          <li class="nav-item">
          
              <a href="/classes/class1/">Class 01: What is Money?</a>
          
          </li>
        
          <li class="nav-item">
          
              <a href="/classes/class2/">Class 02: Cryptography</a>
          
          </li>
        
          <li class="nav-item">
          
              <span class="nav-item-selected">Class 03: Digital Signatures</span></a>
          
          </li>
        
        <li><a href="classes/"><em>More...</em></a></li>
      </ul>

    </nav>

    <a href="/0/">Spring 2015 Course</a>

    

  </div>
</div>

	
    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

    <section id="main">
            
            	<span class="post-date">
                	2 Sep 2015
            	</span>
            	
            
                <div class="phighlight">
                     <a href="/class3.pdf">PDF for printing</a>
                </div>
            

            
            	
            

			
			

			

			

            

<h2 id="schedule:b9b50bf0a87e56763567aaebbc820d47">Schedule</h2>

<p><div class="todo">
<strong>Monday, September 7</strong>: Check-up 1.  This will be a short in-class quiz
  to test your understanding of the main concepts covered so far.  It
  will cover material from the readings (see Class 2 for details) and classes 1-3.</p>

<p><strong>Tuesday, September 15</strong> (8:29pm): <a href="http://www.bitcoin-class.org/ps/ps1">Problem Set 1</a> due.</p>

<p></div></p>

<p><center>
<iframe src="//www.slideshare.net/slideshow/embed_code/key/aX0xcwqcvhABQg"
width="625" height="400" frameborder="2" marginwidth="0"
marginheight="0" scrolling="no"></iframe></p>

<p><div class="caption">
Note: ink markings may not appear in the
embedded viewer.  To see them, <a href="/classes/class3-post.pptx">download the slides</a>.
   </div></p>

<p></center></p>

<h2 id="signatures:b9b50bf0a87e56763567aaebbc820d47">Signatures</h2>

<p>&ldquo;Real-life&rdquo; signatures. Properties:</p>

<ul>
<li>Easy to verify</li>
<li>Forging unlikely</li>
<li>Hard to repudiate</li>
</ul>

<p>Digital signatures. Should have same properties, in the absence of legal forces on the internet.</p>

<p>Topics:</p>

<ul>
<li>Assymetric cryptography</li>
<li>Digital signatures</li>
<li>Elliptic curve cryptography</li>
<li>Implementation pitfalls</li>
</ul>

<p>Ordinary (or symmetric) Crypto</p>

<ul>
<li>Both parties have to agree on a key</li>
</ul>

<p>Diffie-Hellman key exchange</p>

<ul>
<li>Proposed in 1976</li>
<li>Establishes a private secret key, unknown to any evesdropper</li>
</ul>

<p>Whitfield Diffie and Martin E. Hellman, <a href="http://www-ee.stanford.edu/~hellman/publications/24.pdf"><em>New Directions in Cryptography</em></a>, IEEE Transactions on Information Theory, 1976.</p>

<p>The paper concludes with an interesting historical discussion (that gets
bonus points for mentioning Thomas Jefferson):</p>

<blockquote>
<p><em>While at first the public key systems and one-way authentication systems suggested in this paper appear to be unportended by past cryptographic developments, it is possible to view them as the natural outgrowth of trends in cryptography stretching back hundreds of years. Secrecy is at the heart of cryptography. In early cryptography, however, there was a confusion about what was to be kept secret. &hellip; After the invention of the telegraph, the distinction between a general system and a specific key allowed the general system to be compromised, for example by theft of a cryptographic device, without compromising future messages enciphered in new keys. &hellip; The development of computers has led for the first time to a mathematical theory of algorithms which can begin to approach the difficult problem of estimating the computational difficulty of breaking a cryptographic system. The position of mathematical proof may thus come full circle and be reestablished as the best method of certification.</em></p>

<p><em>The last characteristic which we note in the history of cryptography is the division between amateur and professional cryptographers. Skill in production cryptanalysis has always been heavily on the side of the professionals, but innovation, particularly in the design of new types of cryptographic systems, has come primarily from the amateurs. Thomas Jefferson, a cryptographic amateur, invented a system which was still in use in World War II, while the most noted cryptographic system of the twentieth century, the rotor machine, was invented simultaneously by four separate people, all amateurs. We hope this will inspire others to work in this fascinating area in which participation has been discouraged in the recent past by a nearly total government monopoly.</em></p>
</blockquote>

<p>Observe how the them of amateurs being the ones who design the important
cryptographic systems carries through with bitcoin. Although Satoshi&rsquo;s
actual identity is unknown, it seems pretty clear that they are not a
professionally-trained cryptographer, and (so far, at least!) all the
digital currencies developed by world renowned cryptographers have
failed.</p>

<h3 id="discrete-logarithm-problem:b9b50bf0a87e56763567aaebbc820d47">Discrete Logarithm Problem</h3>

<p>Given <span class="math"><em>g</em></span>, <span class="math"><em>y</em></span>, and <span class="math"><em>p</em></span>, find <span class="math"><em>x</em></span> such that <span class="math"><em>g</em><sup><em>x</em></sup> mod <em>p</em> = <em>y</em></span>.</p>

<p><del>Discrete</del> Logarithm Problem: easy to solve for real numbers.</p>

<p>What is the range of elements out of which we are randomly selecting?</p>

<div class="gap"></div>

<h3 id="mod-5-exponentiation:b9b50bf0a87e56763567aaebbc820d47">Mod 5 exponentiation</h3>

<p><strong>Multiplicative order</strong> is the number of multiplication after which the result repeats.</p>

<p>Multiplicative order of <span class="math"><em>g</em></span> is <span class="math"><em>n</em></span> if <span class="math"><em>n</em></span> is the smallest positive integer
such that <span class="math"><em>g</em><sup><em>n</em></sup> = 1</span>.</p>

<h3 id="exponent-modulus:b9b50bf0a87e56763567aaebbc820d47">Exponent Modulus</h3>

<ul>
<li>Multiplicative order is at most <span class="math"><em>p</em> - 1</span>.</li>
<li>Pick random <span class="math"><em>x</em></span> such that <span class="math">0 &le; <em>x</em> &lt; <em>p</em> - 1</span>.</li>
<li><span class="math"><em>g</em><sup><em>a</em></sup> <em>g</em><sup><em>b</em></sup> mod <em>p</em> = <em>g</em><sup><em>a</em>+<em>b</em></sup> mod <em>p</em> = <em>g</em><sup>(<em>a</em>+<em>b</em>) mod <em>n</em></sup> mod <em>p</em></span></li>
</ul>

<h1 id="public-key-cryptography:b9b50bf0a87e56763567aaebbc820d47">Public-key Cryptography</h1>

<ol>
<li>Google announces <span class="math"><em>g</em><sup><em>a</em></sup></span>.</li>
<li>Bob picks random secret <span class="math"><em>b</em></span>, computes <span class="math">(<em>g</em><sup><em>a</em></sup>)<sup><em>b</em></sup>=<em>g</em><sup><em>ab</em></sup></span>.</li>
<li>Bob encrypts message <span class="math"><em>m</em></span> and sends: <span class="math"><em>g</em><sup><em>b</em></sup>, <em>g</em><sup><em>ab</em></sup><em>m</em></span>.</li>
</ol>

<h3 id="man-in-the-middle-mitm:b9b50bf0a87e56763567aaebbc820d47">Man-in-the-middle (MITM)</h3>

<p>Active adversary can still read everything. We have to know messages are coming from the right person.</p>

<h2 id="digital-signatures:b9b50bf0a87e56763567aaebbc820d47">Digital Signatures</h2>

<p>Discrete-log based signature</p>

<h3 id="elgamal-signature-scheme:b9b50bf0a87e56763567aaebbc820d47">ElGamal Signature Scheme</h3>

<ul>
<li>Fixed global parameters: <span class="math"><em>g</em></span>, <span class="math"><em>p</em></span></li>
<li>Private key: <span class="math"><em>a</em></span></li>
<li>Public key: <span class="math"><em>g</em><sup>a</sup> mod <em>p</em></span></li>
<li>Signing:

<ol>
<li>Input: message <span class="math"><em>m</em></span></li>
<li>Pick random <span class="math"><em>k</em></span></li>
<li>Compute <span class="math"><em>r</em> = <em>g</em><sup><em>k</em></sup> mod <em>p</em></span>;
       <span class="math"><em>s</em> = (<em>m</em>-<em>ar</em>)<em>k</em><sup>-1</sup> mod <em>p</em> - 1</span></li>
<li>Send <span class="math">(<em>r</em>, <em>s</em>)</span> with message <span class="math"><em>m</em></span></li>
</ol></li>
<li>Verification:

<ol>
<li>Input: message <span class="math"><em>m</em>, (<em>r</em>,<em>s</em>)</span></li>
<li>Verify that <span class="math"><em>r</em><sup><em>s</em></sup>(<em>g</em><sup><em>a</em></sup>)<sup><em>r</em></sup> = <em>g</em><sup><em>m</em></sup> mod <em>p</em>.</li>
</ol></li>
</ul>

<h2 id="avoiding-overly-long-numbers:b9b50bf0a87e56763567aaebbc820d47">Avoiding (overly) long numbers</h2>

<p>Real-life keys are long. We can use any group where discrete log is hard.</p>

<p>A group is a set of elements and an associated operation such that it satisfies the following:</p>

<ul>
<li><strong>Closure</strong>: <span class="math"><em>a</em> * <em>b</em></span> is also a group element.</li>
<li><strong>Associativity:</strong> for all <span class="math"><em>a</em>, <em>b</em>, <em>c</em>: (<em>a</em><em><em>b</em>)</em><em>c</em> = <em>a</em><em>(<em>b</em></em><em>c</em>)</span>.</li>
<li><strong>Identity element:</strong> there exists an element <span class="math"><em>e</em></span>, such that for every element <span class="math"><em>a</em>: <em>a</em> * <em>e</em> = <em>a</em> = <em>e</em> * <em>a</em></span></li>
<li><strong>Inverse:</strong> for every element <span class="math"><em>a</em></span>, there exists an element <span class="math"><em>b</em></span> such that <span class="math"><em>a</em> * <em>b</em> = <em>e</em> = <em>b</em> * <em>a</em></span>.</li>
</ul>

<p>Additional Cryptographic Properties:</p>

<ul>
<li>Discrete logarithm should be hard</li>
<li>Group operation should be efficient</li>
</ul>

<h3 id="elliptic-curve-cryptography-ecc:b9b50bf0a87e56763567aaebbc820d47">Elliptic Curve Cryptography (ECC)</h3>

<ul>
<li>Group elements are points on a curve, e.g., <span class="math"><em>y</em><sup>2</sup> = <em>x</em><sup>3</sup> + 7</sup>.</li>
<li>Point &ldquo;addition&rdquo; using &ldquo;geometry&rdquo;</li>
</ul>

<h3 id="elliptic-curve-digital-signature-algorithm:b9b50bf0a87e56763567aaebbc820d47">Elliptic Curve Digital Signature Algorithm</h3>

<p>Follows the same structure as ElGamal signature, but only on <span class="math"><em>x</em></span>-coordinate.</p>

<h2 id="pitfalls:b9b50bf0a87e56763567aaebbc820d47">Pitfalls</h2>

<p>If we ever repeat signing nonce, we leak the private key.  Sony actually
did this with Playstation 3 consoles (<a href="https://events.ccc.de/congress/2010/Fahrplan/attachments/1780_27c3_console_hacking_2010.pdf"><em>Console Hacking 2010: PS3 Epic Fail</em></a>, CCC 2010).</p>

<p>Poor randomness makes private keys predictable. Use <code>/dev/urandom</code>
(Linux) or <code>java.security.SecureRandom</code> in Java.  If you use a
pseudorandom number generator that is seeded with an easily guessed
value, you are in big trouble!  A common mistake was to use
<code>Math.random()</code> or <code>srand(time(0))</code>.</p>

<p>Logjam attack: downgrade security during handshake.</p>

<h2 id="notes:b9b50bf0a87e56763567aaebbc820d47">Notes</h2>

<ul>
<li><p>How are digital signatures and real-life signatures different in terms of why we trust them? What stops each from being forged by others?</p></li>

<li><p>Assume somebody really clever has a way of solving the discrete logarithm problem easily. That is, for any given <span class="math"><em>g</em></span>, <span class="math"><em>y</em></span>, and <span class="math"><em>p</em></span>, the adversary can compute <span class="math"><em>x</em></span> such that <span class="math"><em>g</em><sup><em>x</em> mod <em>p</em> = <em>y</em></span>. How can this algorithm be used to break security of Diffie-Hellman protocol?</p></li>

<li><p>What is a nonce? What breaks if we reuse it between encrypted messages?</p></li>

<li><p>In elliptic curve cryptography, why do we use <span class="math">mod <em>p</em></span> integers? What would go wrong if we used real numbers?  What would go wrong if we used unbounded integers?</p></li>
</ul>

	
			

			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					
					<div class="paging-newer">
						<span class="dark-red">Newer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/classes/class4/">Class 04: Checkup</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/announcements/miningpools/">Mining Pools</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">
 
   var disqus_url = '';
   var disqus_shortname = 'davidevans'; 

    
   (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] ||  document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view
    the <a href="http://disqus.com/?ref_noscript">comments powered by
    Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

          
        
      <div class="footer">
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
	<hr class="thin" />

   <div class="funding">
University of Virginia<br>
cs4501: Introduction to Cryptocurrency<br>
Fall 2015
   </div>

	<p></p>
</div>

    </div>
  </div>
	

	

  
<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
